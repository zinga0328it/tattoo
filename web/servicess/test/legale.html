<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assistenza Legale - AiVigilanza</title>
  <style>
    body {
      background: linear-gradient(135deg, #2c1600, #bfa14a 80%, #fffbe6 100%);
      color: #fffbe6;
      font-family: 'Georgia', 'Segoe UI', Arial, serif;
      margin: 0;
      min-height: 100vh;
      overflow-x: hidden;
    }
    .lock-menu-container {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 40px;
      margin-bottom: 30px;
      user-select: none;
    }
    .lock-menu-row {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      width: 100%;
      gap: 18px;
    }
    .lock-menu {
      width: 340px;
      height: 220px;
      background: rgba(34,34,34,0.7);
      border-radius: 30px;
      box-shadow: 0 0 30px #2ecc71aa;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      text-align: center;
    }
    .lock-menu .menu-item {
      width: 260px;
      height: 54px;
      line-height: 54px;
      font-size: 1.45em;
      color: #2ecc71;
      opacity: 0.5;
      transition: all 0.2s;
      background: none;
      border-radius: 20px;
      font-weight: bold;
      position: relative;
      z-index: 1;
      pointer-events: none;
      text-align: center;
    }
    .lock-menu .menu-item.selected {
      background: #2ecc71;
      color: #111;
      font-size: 1.5em;
      opacity: 1;
      box-shadow: 0 2px 12px #2ecc71bb;
      pointer-events: auto;
      cursor: pointer;
    }
    .lock-menu .menu-item.above, .lock-menu .menu-item.below {
      opacity: 0.8;
      font-size: 1em;
      color: #fff;
    }
    .lock-menu .menu-item.far {
      opacity: 0.3;
      font-size: 0.9em;
      color: #aaa;
    }
    #leftBtn, #rightBtn {
      background: #2ecc71;
      color: #111;
      border: none;
      border-radius: 50%;
      width: 64px;
      height: 64px;
      font-size: 2.3em;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 2px 10px #2ecc71aa;
      transition: background 0.2s, color 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #leftBtn:hover, #rightBtn:hover {
      background: #229ED9;
      color: #fff;
    }
    .legale-container {
      background: rgba(34,34,34,0.92);
      border-radius: 24px;
      box-shadow: 0 0 32px #bfa14a99;
      padding: 48px 32px 36px 32px;
      max-width: 540px;
      margin: 60px auto 40px auto;
      text-align: center;
    }
    h1 {
      color: #bfa14a;
      font-size: 2.2em;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }
    h2 {
      color: #fffbe6;
      font-size: 1.25em;
      font-weight: normal;
      margin-bottom: 28px;
    }
    ul {
      text-align: left;
      margin: 28px auto 0 auto;
      padding-left: 0;
      list-style: none;
      max-width: 420px;
    }
    ul li {
      background: #bfa14a22;
      color: #fffbe6;
      border-left: 4px solid #bfa14a;
      border-radius: 8px;
      margin-bottom: 14px;
      padding: 12px 18px;
      font-size: 1.13em;
      font-family: inherit;
      box-shadow: 0 2px 8px #bfa14a33;
    }
    .desc {
      font-size: 1.13em;
      color: #fffbe6;
      margin-bottom: 18px;
      line-height: 1.6;
    }
    .chat-sparkle-container {
      max-width: 420px;
      margin: 36px auto 0 auto;
      background: linear-gradient(135deg, #181818 80%, #2ecc71 120%);
      border-radius: 22px;
      box-shadow: 0 0 32px #2ecc71cc, 0 0 0 4px #222 inset;
      padding: 0 0 18px 0;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      position: relative;
      animation: sparkle-glow 2.5s infinite alternate;
    }
    @keyframes sparkle-glow {
      0% { box-shadow: 0 0 32px #2ecc71cc, 0 0 0 4px #222 inset; }
      100% { box-shadow: 0 0 48px #2ecc71ee, 0 0 0 4px #229ED9 inset; }
    }
    .chat-sparkle-box {
      min-height: 140px;
      max-height: 260px;
      overflow-y: auto;
      padding: 18px 16px 10px 16px;
      font-size: 1em;
      color: #fff;
      background: transparent;
      border-radius: 22px 22px 0 0;
      margin-bottom: 0;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .chat-sparkle-msg {
      display: flex;
      align-items: flex-end;
      gap: 10px;
      margin-bottom: 2px;
      animation: fadeIn 0.5s;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .chat-sparkle-msg.user { justify-content: flex-end; }
    .chat-sparkle-msg.carmela { justify-content: flex-start; }
    .chat-sparkle-bubble {
      padding: 10px 16px;
      border-radius: 18px;
      max-width: 75%;
      word-break: break-word;
      font-size: 1.05em;
      box-shadow: 0 2px 8px #0005;
      background: #2ecc71;
      color: #111;
      border-bottom-right-radius: 6px;
      border-bottom-left-radius: 18px;
      border-top-left-radius: 18px;
      border-top-right-radius: 18px;
      position: relative;
    }
    .chat-sparkle-msg.carmela .chat-sparkle-bubble {
      background: #222;
      color: #2ecc71;
      border-bottom-left-radius: 6px;
      border-bottom-right-radius: 18px;
      border-top-left-radius: 18px;
      border-top-right-radius: 18px;
    }
    .chat-sparkle-form {
      display: flex;
      align-items: center;
      gap: 0;
      border-radius: 0 0 22px 22px;
      background: #181818;
      padding: 0 8px 0 8px;
      border-top: 1px solid #2ecc71;
    }
    .chat-sparkle-input {
      border: none;
      border-radius: 0 0 22px 22px;
      padding: 16px 14px;
      font-size: 1.1em;
      outline: none;
      background: #222;
      color: #fff;
      flex: 1;
      margin: 0;
      transition: box-shadow 0.2s;
      box-shadow: 0 2px 8px #2ecc7133 inset;
    }
    .chat-sparkle-input:focus {
      box-shadow: 0 0 0 2px #2ecc71cc;
    }
    .chat-sparkle-input::placeholder {
      color: #aaa;
    }
    .chat-sparkle-send {
      background: linear-gradient(135deg, #2ecc71 60%, #229ED9 100%);
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 44px;
      height: 44px;
      font-size: 1.5em;
      font-weight: bold;
      cursor: pointer;
      margin-left: 8px;
      box-shadow: 0 2px 10px #2ecc71aa;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s, color 0.2s, box-shadow 0.2s;
    }
    .chat-sparkle-send:hover {
      background: linear-gradient(135deg, #229ED9 60%, #2ecc71 100%);
      color: #fff;
      box-shadow: 0 0 16px #229ED9cc;
    }
    @media (max-width: 700px) {
      .lock-menu {
        width: 98vw;
        height: 120px;
      }
      .lock-menu .menu-item {
        width: 98vw;
        height: 36px;
        font-size: 1.1em;
      }
      #leftBtn, #rightBtn {
        width: 44px;
        height: 44px;
        font-size: 1.5em;
      }
      .legale-container { padding: 18px 4vw; }
      .chat-sparkle-container { max-width: 98vw; }
      .chat-sparkle-box { padding: 10px 4px 6px 4px; }
      .chat-sparkle-input { padding: 12px 8px; font-size: 1em; }
      .chat-sparkle-send { width: 36px; height: 36px; font-size: 1.1em; }
    }
    </style>
</head>
<body>
      <!-- Barra bandierine per selezione lingua, visibile anche senza JS -->
      <div class="flag-bar" style="display:flex;gap:8px;justify-content:flex-end;padding:10px 18px 0 0;">
        <button class="flag-btn" data-lang="it" title="Italiano" style="font-size:1.7em;background:none;border:none;cursor:pointer;">ðŸ‡®ðŸ‡¹</button>
        <button class="flag-btn" data-lang="en" title="English" style="font-size:1.7em;background:none;border:none;cursor:pointer;">ðŸ‡¬ðŸ‡§</button>
        <button class="flag-btn" data-lang="fr" title="FranÃ§ais" style="font-size:1.7em;background:none;border:none;cursor:pointer;">ðŸ‡«ðŸ‡·</button>
        <button class="flag-btn" data-lang="de" title="Deutsch" style="font-size:1.7em;background:none;border:none;cursor:pointer;">ðŸ‡©ðŸ‡ª</button>
        <button class="flag-btn" data-lang="es" title="EspaÃ±ol" style="font-size:1.7em;background:none;border:none;cursor:pointer;">ðŸ‡ªðŸ‡¸</button>
        <button class="flag-btn" data-lang="ar" title="Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©" style="font-size:1.7em;background:none;border:none;cursor:pointer;">ðŸ‡¸ðŸ‡¦</button>
        <button class="flag-btn" data-lang="ru" title="Ð ÑƒÑÑÐºÐ¸Ð¹" style="font-size:1.7em;background:none;border:none;cursor:pointer;">ðŸ‡·ðŸ‡º</button>
        <button class="flag-btn" data-lang="zh" title="ä¸­æ–‡" style="font-size:1.7em;background:none;border:none;cursor:pointer;">ðŸ‡¨ðŸ‡³</button>
        <button class="flag-btn" data-lang="ja" title="æ—¥æœ¬èªž" style="font-size:1.7em;background:none;border:none;cursor:pointer;">ðŸ‡¯ðŸ‡µ</button>
        <button class="flag-btn" data-lang="hi" title="à¤¹à¤¿à¤¨à¥à¤¦à¥€" style="font-size:1.7em;background:none;border:none;cursor:pointer;">ðŸ‡®ðŸ‡³</button>
      </div>
      <div class="lock-menu-container">
        <div class="lock-menu-row">
          <button id="leftBtn" aria-label="Precedente">&#9664;</button>
          <div class="lock-menu" id="lockMenu">
            <!-- Menu items will be injected here by JS -->
          </div>
          <button id="rightBtn" aria-label="Successivo">&#9654;</button>
        </div>
      </div>
      <div class="legale-container">
        <h1>iVigilanza â€“ Soluzioni di Sicurezza e Assistenza Legale</h1>
        <h2>Il tuo partner di fiducia per la sicurezza e la tutela legale</h2>
        <div class="desc">
          AiVigilanza Ã¨ il tuo partner di fiducia per la sicurezza e lâ€™assistenza legale.<br>
          Collaboriamo direttamente con studi legali penali e civili specializzati, ai quali deleghiamo ogni aspetto legale serio e pesante.
        </div>
        <ul>
          <li>Controllo proprietÃ </li>
          <li>Monitoraggio beni</li>
          <li>Consulenze su questioni civili e penali</li>
          <li>Supporto per contenziosi</li>
          <li>Difesa legale penale</li>
          <li>Mediazioni, contratti e consulenze stragiudiziali</li>
          <li>Assistenza giudiziaria completa</li>
          <li>Recupero crediti</li>
        </ul>
        <div class="desc" style="margin-top:28px;">
          Con AiVigilanza, proteggere ciÃ² che ti sta a cuore diventa una missione su misura: <b>rapidi, discreti e professionali</b>.
        </div>
      </div>
      <div class="chat-sparkle-container">
        <div class="chat-sparkle-box" id="chat-box"></div>
        <form class="chat-sparkle-form" onsubmit="sendMessage(event)">
          <input type="text" id="chat-input" class="chat-sparkle-input" placeholder="Scrivi la tua domanda legale o sulla sicurezza..." autocomplete="off">
          <button type="submit" class="chat-sparkle-send" aria-label="Invia"><span>Invia</span></button>
        </form>
      </div>
      <script>
        // Menu stile "lucchetto a combinazione"
        const menuItems = [
          { label: 'Home', href: 'index.html' },
          { label: 'Guardiania', href: 'guardiania.html' },
          { label: 'Legale', href: 'legale.html' },
          { label: 'Domotica', href: 'domotica.html' },
          { label: 'Criptotelefonia', href: 'https://vpn-gypsy.com/' },
          { label: '7070', href: 'antivirus.html' },
          { label: 'Bonifiche', href: 'bonifiche.html' },
          { label: 'Contatti', href: 'contatti.html' },
          { label: 'Chi siamo', href: 'chisiamo.html' }
        ];
        let selectedIdx = 2;
        const lockMenu = document.getElementById('lockMenu');
        function renderMenu() {
          lockMenu.innerHTML = '';
          for (let i = -2; i <= 2; i++) {
            let idx = (selectedIdx + i + menuItems.length) % menuItems.length;
            let item = document.createElement('a');
            item.className = 'menu-item';
            if (i === 0) item.classList.add('selected');
            else if (Math.abs(i) === 1) item.classList.add(i < 0 ? 'above' : 'below');
            else item.classList.add('far');
            item.href = menuItems[idx].href;
            item.textContent = menuItems[idx].label;
            if (i === 0) item.tabIndex = 0;
            lockMenu.appendChild(item);
          }
        }
        function moveUp() {
          selectedIdx = (selectedIdx - 1 + menuItems.length) % menuItems.length;
          renderMenu();
        }
        function moveDown() {
          selectedIdx = (selectedIdx + 1) % menuItems.length;
          renderMenu();
        }
        document.getElementById('leftBtn').onclick = moveUp;
        document.getElementById('rightBtn').onclick = moveDown;
        document.addEventListener('keydown', e => {
          if (e.key === 'ArrowLeft') { moveUp(); e.preventDefault(); }
          if (e.key === 'ArrowRight') { moveDown(); e.preventDefault(); }
        });
        let touchStartX = null;
        lockMenu.addEventListener('touchstart', e => {
          touchStartX = e.touches[0].clientX;
        });
        lockMenu.addEventListener('touchend', e => {
          if (touchStartX === null) return;
          let deltaX = e.changedTouches[0].clientX - touchStartX;
          if (deltaX < -30) moveDown();
          if (deltaX > 30) moveUp();
          touchStartX = null;
        });
        renderMenu();
        // Chat Carmela professionale con effetto scintilla e API ready
        const chatBox = document.getElementById('chat-box');
        const chatInput = document.getElementById('chat-input');
        const chatForm = document.querySelector('.chat-sparkle-form');
        function appendMsg(text, sender) {
          const msgDiv = document.createElement('div');
          msgDiv.className = 'chat-sparkle-msg ' + sender;
          const bubble = document.createElement('div');
          bubble.className = 'chat-sparkle-bubble';
          bubble.textContent = text;
          msgDiv.appendChild(bubble);
          chatBox.appendChild(msgDiv);
          chatBox.scrollTop = chatBox.scrollHeight;
        }
        async function sendMessage(e) {
          if (e) e.preventDefault();
          const text = chatInput.value.trim();
          if (!text) return;
          appendMsg(text, 'user');
          chatInput.value = '';
          chatInput.focus();
          appendMsg('Carmela sta scrivendo...', 'carmela');
          try {
            const response = await fetch('/chat', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ message: text })
            });
            const data = await response.json();
            chatBox.removeChild(chatBox.lastChild);
            appendMsg(data.reply || 'Errore, riprova piÃ¹ tardi!', 'carmela');
          } catch {
            chatBox.removeChild(chatBox.lastChild);
            appendMsg('Errore di connessione con Carmela.', 'carmela');
          }
        }
        appendMsg('Benvenuto, sono lâ€™Avv. Carmela, consulente legale e direttrice dellâ€™istituto di vigilanza. Come posso aiutarti oggi?', 'carmela');
      </script>
      <script src="traduzione/legale.js"></script>
      <script>
      function setLegaleLanguage(lang) {
        const t = translationsLegale[lang] || translationsLegale['it'];
        // Titoli e descrizioni
        document.querySelector('.legale-container h1').innerHTML = t.title;
        document.querySelector('.legale-container h2').innerHTML = t.subtitle;
        document.querySelectorAll('.legale-container .desc')[0].innerHTML = t.desc1;
        document.querySelectorAll('.legale-container .desc')[1].innerHTML = t.desc2;
        // Lista servizi
        const ul = document.querySelector('.legale-container ul');
        ul.innerHTML = '';
        t.list.forEach(item => {
          const li = document.createElement('li');
          li.innerHTML = item;
          ul.appendChild(li);
        });
        // Chat
        chatBox.innerHTML = '';
        appendMsg(t.chatWelcome, 'carmela');
        chatInput.placeholder = t.chatPlaceholder;
      }
      // Collega le bandiere
      document.querySelectorAll('.flag-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          setLegaleLanguage(this.getAttribute('data-lang'));
        });
      });
      // Lingua di default
      setLegaleLanguage('it');
      </script>
      <script>
(function() {
  function uuidv4() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
      var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
      return v.toString(16);
    });
  }
  function getOrSetUserId() {
    let match = document.cookie.match(/(?:^|; )user_id=([^;]*)/);
    if (match) return match[1];
    let id = uuidv4();
    document.cookie = "user_id=" + id + "; path=/; max-age=31536000";
    return id;
  }
  function registraVisita() {
    const user_id = getOrSetUserId();
    fetch("http://93.57.240.131:2626/?user_id=" + encodeURIComponent(user_id), {
      method: "GET",
      credentials: "include"
    });
  }
  registraVisita();
})();
</script>
<script>
  // Lista di browser umani
  const safeBrowsers = ["Chrome", "Firefox", "Safari", "Edg", "Opera"];
  let isBot = true;
  for (let b of safeBrowsers) {
    if (navigator.userAgent.includes(b)) {
      isBot = false;
      break;
    }
  }
  // Se Ã¨ un bot, lo reindirizzi alla trappola
  if (isBot) {
    window.location.href = "/home.html";
  }
</script>
</body>
</html>
